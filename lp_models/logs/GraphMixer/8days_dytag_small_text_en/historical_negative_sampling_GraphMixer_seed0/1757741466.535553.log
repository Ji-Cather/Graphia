2025-09-13 13:31:06,535 - root - INFO - ********** Run 1 starts. **********
2025-09-13 13:31:06,536 - root - INFO - configuration is Namespace(data_name='8days_dytag_small_text_en', pred_ratio=0.15, use_feature='bert', bwr=1980, time_window=86400, cm_order=True, batch_size=256, model_name='GraphMixer', gpu=0, num_neighbors=20, sample_neighbor_strategy='recent', time_scaling_factor=1e-06, num_walk_heads=8, num_heads=2, num_layers=2, walk_length=1, time_gap=2000, time_feat_dim=100, position_feat_dim=172, edge_bank_memory_mode='unlimited_memory', time_window_mode='fixed_proportion', patch_size=1, channel_embedding_dim=50, max_input_sequence_length=48, learning_rate=0.0001, dropout=0.1, num_epochs=200, optimizer='Adam', weight_decay=0.0, patience=5, val_ratio=0.15, test_ratio=0.15, num_runs=1, test_interval_epochs=10, negative_sample_strategy='historical', load_best_configs=True, save_root='/data/jiarui_ji/llmggen/LLMGGen/lp_models/', data_root='/data/jiarui_ji/llmggen/LLMGGen/data/', device='cuda:0', seed=0, load_model_name='GraphMixer_seed0bert', save_result_name='historical_negative_sampling_GraphMixer_seed0')
2025-09-13 13:31:06,791 - root - INFO - model -> Sequential(
  (0): GraphMixer(
    (time_encoder): TimeEncoder(
      (w): Linear(in_features=1, out_features=100, bias=True)
    )
    (projection_layer): Linear(in_features=228, out_features=128, bias=True)
    (mlp_mixers): ModuleList(
      (0-1): 2 x MLPMixer(
        (token_norm): LayerNorm((20,), eps=1e-05, elementwise_affine=True)
        (token_feedforward): FeedForwardNet(
          (ffn): Sequential(
            (0): Linear(in_features=20, out_features=10, bias=True)
            (1): GELU(approximate='none')
            (2): Dropout(p=0.1, inplace=False)
            (3): Linear(in_features=10, out_features=20, bias=True)
            (4): Dropout(p=0.1, inplace=False)
          )
        )
        (channel_norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        (channel_feedforward): FeedForwardNet(
          (ffn): Sequential(
            (0): Linear(in_features=128, out_features=512, bias=True)
            (1): GELU(approximate='none')
            (2): Dropout(p=0.1, inplace=False)
            (3): Linear(in_features=512, out_features=128, bias=True)
            (4): Dropout(p=0.1, inplace=False)
          )
        )
      )
    )
    (output_layer): Linear(in_features=256, out_features=128, bias=True)
  )
  (1): MergeLayer(
    (fc1): Linear(in_features=256, out_features=128, bias=True)
    (fc2): Linear(in_features=128, out_features=1, bias=True)
    (act): ReLU()
  )
)
2025-09-13 13:31:06,791 - root - INFO - model name: GraphMixer, #parameters: 1440436 B, 1406.67578125 KB, 1.3737068176269531 MB.
2025-09-13 13:31:06,791 - root - INFO - load model /data/jiarui_ji/llmggen/LLMGGen/lp_models/saved_models/GraphMixer/8days_dytag_small_text_en/GraphMixer_seed0bert/GraphMixer_seed0bert.pkl
2025-09-13 13:31:06,798 - root - INFO - get final performance on dataset 8days_dytag_small_text_en...
2025-09-13 13:37:22,150 - root - INFO - validate loss: 0.3739
2025-09-13 13:37:22,152 - root - INFO - validate H1, 0.0638
2025-09-13 13:37:22,152 - root - INFO - validate H3, 0.0664
2025-09-13 13:37:22,152 - root - INFO - validate H10, 0.0926
2025-09-13 13:37:22,152 - root - INFO - new node validate loss: 0.6442
2025-09-13 13:37:22,152 - root - INFO - new node validate H1, 0.0039
2025-09-13 13:37:22,153 - root - INFO - new node validate H3, 0.0039
2025-09-13 13:37:22,153 - root - INFO - new node validate H10, 0.0291
2025-09-13 13:37:22,153 - root - INFO - test loss: 0.4466
2025-09-13 13:37:22,153 - root - INFO - test H1, 0.0653
2025-09-13 13:37:22,153 - root - INFO - test H3, 0.0731
2025-09-13 13:37:22,153 - root - INFO - test H10, 0.0899
2025-09-13 13:37:22,153 - root - INFO - new node test loss: 0.6309
2025-09-13 13:37:22,154 - root - INFO - new node test H1, 0.0138
2025-09-13 13:37:22,154 - root - INFO - new node test H3, 0.0157
2025-09-13 13:37:22,154 - root - INFO - new node test H10, 0.0235
2025-09-13 13:37:22,154 - root - INFO - Run 1 cost 375.62 seconds.
2025-09-13 13:37:22,155 - root - INFO - save negative sampling results at /data/jiarui_ji/llmggen/LLMGGen/lp_models/saved_results/GraphMixer/8days_dytag_small_text_en/historical_negative_sampling_GraphMixer_seed0.json
2025-09-13 13:37:22,155 - root - INFO - metrics over 1 runs:
2025-09-13 13:37:22,155 - root - INFO - validate H1, [0.06379193063677713]
2025-09-13 13:37:22,156 - root - INFO - average validate H1, 0.0638 ± nan
2025-09-13 13:37:22,156 - root - INFO - validate H3, [0.0663960973034438]
2025-09-13 13:37:22,156 - root - INFO - average validate H3, 0.0664 ± nan
2025-09-13 13:37:22,157 - root - INFO - validate H10, [0.09264843242365171]
2025-09-13 13:37:22,157 - root - INFO - average validate H10, 0.0926 ± nan
2025-09-13 13:37:22,157 - root - INFO - new node validate H1, [0.00390625]
2025-09-13 13:37:22,157 - root - INFO - average new node validate H1, 0.0039 ± nan
2025-09-13 13:37:22,157 - root - INFO - new node validate H3, [0.00390625]
2025-09-13 13:37:22,157 - root - INFO - average new node validate H3, 0.0039 ± nan
2025-09-13 13:37:22,157 - root - INFO - new node validate H10, [0.029060132575757576]
2025-09-13 13:37:22,158 - root - INFO - average new node validate H10, 0.0291 ± nan
2025-09-13 13:37:22,158 - root - INFO - test H1, [0.06532300420168068]
2025-09-13 13:37:22,158 - root - INFO - average test H1, 0.0653 ± nan
2025-09-13 13:37:22,158 - root - INFO - test H3, [0.07313550420168068]
2025-09-13 13:37:22,158 - root - INFO - average test H3, 0.0731 ± nan
2025-09-13 13:37:22,158 - root - INFO - test H10, [0.0898765756302521]
2025-09-13 13:37:22,158 - root - INFO - average test H10, 0.0899 ± nan
2025-09-13 13:37:22,159 - root - INFO - new node test H1, [0.013765625]
2025-09-13 13:37:22,159 - root - INFO - average new node test H1, 0.0138 ± nan
2025-09-13 13:37:22,159 - root - INFO - new node test H3, [0.01571875]
2025-09-13 13:37:22,159 - root - INFO - average new node test H3, 0.0157 ± nan
2025-09-13 13:37:22,159 - root - INFO - new node test H10, [0.02353125]
2025-09-13 13:37:22,159 - root - INFO - average new node test H10, 0.0235 ± nan
